<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ゲーム開発者ポートフォリオ</title>
  <style>
    body { margin:0; background:#0f0f0f; color:#f2f2f2; font-family:'Segoe UI',sans-serif; line-height:1.5;}
    header {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 960px;
      z-index: 1000;
      background: #0f0f0f;
      padding: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    header h1 { color:#78f2c3; margin:0; font-size:1.8rem; }
    .links { display:flex; flex-wrap:wrap; margin-top:0.5rem; }
    .links a { margin-right:1rem; color:#3794FF; text-decoration:none; font-size:1rem; }
    .resume-button { background:#3794FF; padding:0.5rem 1rem; border:none; border-radius:5px; color:#000; text-decoration:none; font-weight:bold; }
    .section { padding:2rem 1rem; max-width:960px; margin:0 auto; }
    .section h2 { font-size:1.6rem; margin-bottom:1rem; }
    .project-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:1.5rem; }
    .project-link { text-decoration:none; color:inherit; }
    .project { background:#0f0f0f; padding:1rem; border-radius:8px; display:flex; flex-direction:column; transition:transform 0.2s; }
    .project:hover { transform:translateY(-4px); }
    .media-container {
      position: relative;
      width: 100%;
      padding-top: 56.25%; /* 16:9 Aspect Ratio */
      overflow: hidden;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    .media-container img,
    .media-container video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: opacity 0.3s ease;
    }
    .media-container video {
      opacity: 0;
      pointer-events: none;
    }
    .media-container:hover video {
      opacity: 1;
    }
    .media-container:hover img {
      opacity: 0;
    }
    .media-container iframe { display: none; }
    /* ホバー時の動画再生を無効化 */
    /* .project:hover .media-container iframe { opacity:1; } */
    /* .project:hover .media-container img { opacity:0; } */
    .project h2 { color:#007ACC; margin:0.75rem 0 0.5rem; font-size:1.2rem; }
    .project small { color:#ccc; font-size:0.7rem; display: flex; gap: 0.5rem;}
    .project small .tools::before {content: '🛠️';}
    .project small .duration::before {content: '⏳';}
    .project p { margin-top:0.5rem; font-size:0.95rem; flex-grow:1; }
    /* 技術タグ */
    .tech-tags { margin-top:1rem; }
    .tech-tag { display:inline-block; border:1px solid #78f2c3; border-radius:4px; padding:0.25rem 0.5rem; margin:0.25rem; font-size:0.9rem; color:#78f2c3; }
    @media (max-width:600px) { .project-grid { grid-template-columns:1fr; } }
    @media (max-width:600px) {
      .project-grid { grid-template-columns:1fr; }
      header { flex-direction:column; align-items:flex-start; }
      header h1 { font-size:1.6rem; }
      .links a { margin-right:0.75rem; font-size:0.9rem; }
      .section { padding:1rem; }
      .project h2 { font-size:1.1rem; }
      .project small, .project p { font-size:0.85rem; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Goromatsu</h1>
    <div class="links">
      <a href="https://x.com/_goromatsu">X</a>
      <a href="https://github.com/goromatsu">GitHub</a>
      <a href="#" class="resume-button">Resume ↓</a>
    </div>
  </header>
  <div class="section">
    <h2>ゲーム開発者ポートフォリオ</h2>
    <div class="project-grid">
      <!-- 各プロジェクト要素 -->
      <!-- プロジェクト1 -->
      <a href="detail.html?id=1" class="project-link">
        <div class="project">
          <div class="media-container">
            <img src="images/project_1.jpg" alt="プロジェクトA サムネイル">
            <video loop muted preload="metadata" width="100%" height="100%" style="display: block;">
              <source src="/videos/test.mp4" type="video/mp4">
              お使いのブラウザは動画の再生をサポートしていません。
            </video>
          </div>
          <h2>サンプルプロジェクトA (2023)</h2>
          <small>
            <span class="tools">UEFN (Verse)</span>
            <span class="duration">2週間</span>
          </small>
          <p>基本的な3Dアクションのプロトタイプ。移動とカメラ制御を実装。</p>
        </div>
      </a>
      <!-- プロジェクト2 -->
      <a href="detail.html?id=2" class="project-link">
        <div class="project">
          <div class="media-container">
            <img src="images/project_2.jpg" alt="プロジェクトB サムネイル">
            <video loop muted preload="none">
              <source src="videos/project_2.mp4" type="video/mp4">
              お使いのブラウザは動画の再生をサポートしていません。
            </video>
          </div>
          <h2>サンプルプロジェクトB (2022)</h2>          
          <small>
            <span class="tools">UEFN (Verse)</span>
            <span class="duration">2週間</span>
          </small>
          <p>2Dプラットフォーマーのデモ。アニメーションと衝突判定を実装。</p>
        </div>
      </a>
      <!-- プロジェクト3 -->
      <a href="detail.html?id=3" class="project-link">
        <div class="project">
          <div class="media-container">
            <img src="images/project_3.jpg" alt="プロジェクトC サムネイル">
            <video loop muted preload="none">
              <source src="videos/project_3.mp4" type="video/mp4">
              お使いのブラウザは動画の再生をサポートしていません。
            </video>
          </div>
          <h2>サンプルプロジェクトC (2024)</h2>
          <small>
            <span class="tools">UEFN (Verse)</span>
            <span class="duration">2週間</span>
          </small>
          <p>フォトリアルな環境でのウォークスルーデモ。ライティングを調整。</p>
        </div>
      </a>
      <!-- プロジェクト4 -->
      <a href="detail.html?id=4" class="project-link">
        <div class="project">
          <div class="media-container">
            <img src="images/project_4.jpg" alt="プロジェクトD サムネイル">
            <video loop muted preload="none">
              <source src="videos/project_4.mp4" type="video/mp4">
              お使いのブラウザは動画の再生をサポートしていません。
            </video>
          </div>
          <h2>サンプルプロジェクトD (2021)</h2>
          <small>
            <span class="tools">UEFN (Verse)</span>
            <span class="duration">1週間</span>
          </small>
          <p>ブラウザゲームのミニゲーム。スコアシステムとレスポンシブ対応。</p>
        </div>
      </a>
      <!-- プロジェクト5 -->
      <a href="detail.html?id=5" class="project-link">
        <div class="project">
          <div class="media-container">
            <img src="images/project_5.jpg" alt="プロジェクトE サムネイル">
            <video loop muted preload="none">
              <source src="videos/project_5.mp4" type="video/mp4">
              お使いのブラウザは動画の再生をサポートしていません。
            </video>
          </div>
          <h2>サンプルプロジェクトE (2020)</h2>          
          <small>
            <span class="tools">UEFN (Verse)</span>
            <span class="duration">2週間</span>
          </small>
          <p>サイドスクロールシューティング。シンプルな敵AIを実装。</p>
        </div>
      </a>
      <!-- プロジェクト6 -->
      <a href="detail.html?id=6" class="project-link">
        <div class="project">
          <div class="media-container">
            <img src="images/project_6.jpg" alt="プロジェクトF サムネイル">
            <video loop muted preload="none">
              <source src="videos/project_6.mp4" type="video/mp4">
              お使いのブラウザは動画の再生をサポートしていません。
            </video>
          </div>
          <h2>サンプルプロジェクトF (2019)</h2>         
          <small>
            <span class="tools">UEFN (Verse)</span>
            <span class="duration">2日</span>
          </small>
          <p>2Dゲームエンジンの基礎。レンダリングパイプラインを自作。</p>
        </div>
      </a>
    </div>
    <!-- 技術要素セクション -->
    <div class="section tech-section">
      <h2>技術経験</h2>
      <div class="tech-tags">
        <span class="tech-tag">UEFN</span>
        <span class="tech-tag">Verse</span>
        <span class="tech-tag">Unreal Engine</span>
        <span class="tech-tag">Godot</span>
        <span class="tech-tag">Unity</span>
        <span class="tech-tag">C</span>
        <span class="tech-tag">C++</span>
        <span class="tech-tag">C#</span>
        <span class="tech-tag">GdScript</span>
        <span class="tech-tag">Git</span>
      </div>
    </div>
  </div>
  <script>
    // マウスオーバーで動画を再生
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOMが読み込まれました');
      const mediaContainers = document.querySelectorAll('.media-container');
      
      mediaContainers.forEach((container, index) => {
        console.log(`メディアコンテナ #${index + 1} を処理中...`);
        const video = container.querySelector('video');
        const img = container.querySelector('img');
        
        if (!video) {
          console.error('動画要素が見つかりません');
          return;
        }
        if (!img) {
          console.error('画像要素が見つかりません');
          return;
        }

        // 動画の情報をログに出力
        console.log(`動画ソース: ${video.querySelector('source')?.src}`);
        console.log(`動画の準備状態: ${video.readyState} (0=HAVE_NOTHING, 1=HAVE_METADATA, 2=HAVE_CURRENT_DATA, 3=HAVE_FUTURE_DATA, 4=HAVE_ENOUGH_DATA)`);
        
        // 動画の読み込みチェック
        const checkVideo = () => {
          console.log(`動画の読み込み状態チェック: ${video.readyState}`);
          // 動画のメタデータを取得
          if (video.readyState >= 1) { // HAVE_ENOUGH_DATA
            console.log('動画のメタデータが利用可能です');
            // 動画が利用可能な場合
            video.style.opacity = '0';
            video.style.pointerEvents = 'none';
            
            const onMouseEnter = function() {
              console.log('マウスオーバー: 動画再生を試みます');
              video.play().then(() => {
                console.log('動画の再生に成功しました');
              }).catch(e => {
                console.error('動画の再生に失敗しました:', e);
                // 再生に失敗した場合も画像を表示
                video.style.opacity = '0';
                img.style.opacity = '1';
              });
            };
            
            const onMouseLeave = function() {
              console.log('マウスアウト: 動画を一時停止');
              video.pause();
              video.currentTime = 0;
              video.style.opacity = '0';
              img.style.opacity = '1';
            };

            // イベントリスナーを削除してから追加（重複防止）
            container.removeEventListener('mouseenter', onMouseEnter);
            container.removeEventListener('mouseleave', onMouseLeave);
            container.addEventListener('mouseenter', onMouseEnter);
            container.addEventListener('mouseleave', onMouseLeave);

            // 動画の再生状態に応じて画像の表示を切り替え
            const onPlay = () => {
              console.log('動画再生中');
              video.style.opacity = '1';
              img.style.opacity = '0';
            };

            video.addEventListener('play', onPlay);

            // 一度設定したらイベントリスナーを削除
            video.removeEventListener('loadeddata', checkVideo);
          }
        };

        // エラーハンドリング
        const handleError = function(e) {
          console.error('動画の読み込みに失敗しました:', {
            src: video.querySelector('source')?.src,
            error: e,
            readyState: video.readyState,
            networkState: video.networkState,
            errorState: video.error
          });
          // 動画を非表示にし、画像を表示
          video.style.display = 'none';
          img.style.opacity = '1';
          // マウスオーバー時のイベントを削除
          container.onmouseenter = null;
          container.onmouseleave = null;
        };

        // 動画の読み込みが完了したらチェック
        if (video.readyState >= 1) {
          console.log('動画はすでに読み込み済みです');
          checkVideo();
        } else {
          console.log('動画の読み込みを待機中...');
          video.addEventListener('loadeddata', checkVideo);
          video.addEventListener('error', handleError);
        }
        
        // 初期状態でエラーチェック
        setTimeout(() => {
          if (video.readyState === 0) { // HAVE_NOTHING
            console.warn('動画の読み込みが開始されていません。preload属性を確認してください。');
          }
        }, 1000);
      });
      
      // グローバルなエラーハンドラ
      window.addEventListener('error', function(e) {
        console.error('グローバルエラー:', e);
      });
    });
  </script>
</body>
</html>
